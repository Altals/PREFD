# 19 偏微分方程综述和通过有限差分研究静电学

> 本章是关于偏微分方程的几个章节中的第一章；
> 因为偏微分方程比常微分方程更复杂，而且每种类型的偏微分方程都需要自己的算法。
> 我们在本章开始时讨论了一般的偏微分方程，以及每种类型的唯一解决方案的要求。
> 然后我们进入正题，研究在空间晶格上求解泊松方程和拉普拉斯方程的简单但强大的有限差分方法。
> 第23章介绍了求解相同方程的更复杂但最终更有效的有限元方法。

## 19.1 偏微分方程(PDE)概述

诸如温度和压力之类的物理量在空间和时间上都是连续变化的。作为我们的世界，用于描述这些量的函数或场$U(x,y,z,t)$必须包含独立的空间和时间变化。随着时间的推移，任何一个位置的$U(x,y,z,t)$的变化都会影响相邻点的场。这意味着，描述U对四个独立时空变量依赖性的动力学方程必须用偏导数来表示，因此，与常微分方程（ODE）相比，方程必须是偏微分方程（PDE）。

双自变量PDE的最一般形式是：

$$A\frac{\partial^2 U}{\partial x^2}+2B\frac{\partial^2 U}{\partial x \partial y}+C\frac{\partial^2 U}{\partial y^2}+D\frac{\partial U}{\partial x}+E\frac{\partial U}{\partial y}=F\tag{19.1}$$

其中A、B、C和F是变量x和y的任意函数。在表19.1中，我们通过第二行中判别式$d=AC−B^2$的值定义了偏微分方程的类别，并在第三行和第四行中给出了例子。

表 19.1 基于判别式d的值的三类偏微分方程
|椭圆形|抛物线|双曲的|
|:---|:---|:---|
|$d=AC-B^2>0$|$d=AC-B^2=0$|$d=AC-B^2<0$|
|$\nabla^2U(x)=-4\pi\rho(x)$|$\nabla^2U(x,t)=a\frac{\partial U}{\partial t}$|$\nabla^2U(x,t)=c^{-2}\frac{\partial^2U}{\partial t^2}$|
|泊松|热|波|

我们通常认为椭圆方程包含所有变量的二阶导数，所有变量在等号的同一侧都有相同的符号；一个抛物方程，包含一个变量中的一阶导数和另一个变量的二阶导数；双曲方程包含所有变量的二阶导数，当放在等号的同一侧时，符号相反。

在解决了足够多的问题后，人们通常会发展出一些物理直觉，即对于给定的物理情况，是否有足够的边界条件来存在唯一的解（当然，这是对必要的初始条件的补充）。表19.2给出了每种PDE存在唯一解的必要边界条件。例如，两端绑着的绳子和放置在无限热浴中的加热棒都是边界条件足够的物理情况。如果边界条件是周围闭合曲面上解的值，则我们有一个狄利克雷边界条件。如果边界条件是周围表面的法向导数的值，那么我们就有了诺依曼边界条件。如果解及其导数的值都是在闭合边界上指定的，则我们有一个柯西边界条件。尽管具有足够的边界条件对于唯一解是必要的，但具有太多的边界条件，例如诺伊曼和狄拉克，可能是不存在解的过度指定。

数值求解偏微分方程与求解常微分方程在许多方面不同。首先，因为我们能够以标准形式编写所有偏微分方程：

$$\frac{dy(t)}{dt}=f(y,t)\tag{19.2}$$

以t为单个自变量，我们可以使用标准算法（如rk4）来求解所有此类方程。然而，由于偏微分方程有几个自变量，例如$\rho(x,y,z,t)$，我们必须同时独立地将（19.2）应用于每个变量，这将非常复杂。其次，由于偏微分方程比常微分方程要求解更多的方程，我们需要的信息比两个初始条件$[x(0),\dot{x}(0)]$更多。此外，由于每个PDE通常都有自己特定的边界条件集，我们必须为每个特定的问题开发一个特殊的算法。

## 19.2 静电势

你的*问题*是找到图19.1所示的无电荷正方形*内*所有点的电势。该区域的底部和侧面由“接地”（保持0V）的电线组成。顶部导线连接到电压源，该电压源将其保持在恒定的100V。

***???Picture19.1???***

a. 正方形内的空间阴影区域，我们通过求解拉普拉斯方程来确定其中的电势。顶部有一根保持恒定100 V的电线，侧面和底部有一根接地线（虚线）。<br>
b. 使用关于x和y的函数计算出的电势。阴影xy平面上的投影是等电位（轮廓）线。

### 19.2.1 拉普拉斯椭圆偏微分方程（理论）

我们认为图19.1中的整个正方形是我们的边界，上面有规定的电压。如果我们想象无限小的绝缘体放在盒子的顶部，那么我们将有一个闭合的边界。因为势的值是在所有边上给出的，所以我们在边界上有诺依曼条件，根据表19.2，这是一个唯一且稳定的解。

表 19.2 偏微分方程的边界条件和唯一性之间的关系
|边界条件|椭圆|抛物|双曲|
|:---|:---|:---|:---|
|狄利克雷开曲面|过少指定|过少指定|独特且稳定(1D)|
|狄利克雷闭曲面|独特且稳定|过多指定|过多指定|
|诺依曼开曲面|过少指定|过少指定|独特且稳定(1D)|
|诺依曼闭曲面|独特且稳定|过多指定|过多指定|
|柯西开曲面|非物理的|独特且稳定|过多指定|
|柯西闭曲面|过多指定|过多指定|过多指定|

从经典电动力学可知，由静电荷产生的电势$U(x)$满足泊松PDE：

$$\nabla^2U(x)=-4\pi\rho(x)\tag{19.3}$$

其中$\rho(x)$是电荷密度。在空间的无电荷区域，即$\rho(x)=0$的区域中，电势满足拉普拉斯方程：

$$\nabla^2U(x)=0\tag{19.4}$$

这两个方程都是出现在各种应用中的椭圆偏微分方程。我们在二维直角坐标中求解它们：

$$\frac{\partial^2U(x,y)}{\partial x^2}+\frac{\partial^2U(x,y)}{\partial y^2}=0\tag{19.5}$$

$$\frac{\partial^2U(x,y)}{\partial x^2}+\frac{\partial^2U(x,y)}{\partial y^2}=-4\pi\rho(x)\tag{19.6}$$

在这两种情况下，我们都看到电势同时取决于x和y。对于拉普拉斯方程，作为场源的电荷通过指定空间某个区域的电势值间接进入；对于泊松方程，它们直接输入。

## 19.3 偏微分方程的傅立叶级数解

对于图19.1中的简单几何，拉普拉斯方程（19.5）的解析解以无穷级数的形式存在。如果我们假设解是x和y的独立函数的乘积，并将乘积代入（19.5），我们得到：

$$U(x,y)=X(x)Y(y) => \frac{d^2X(x)/dx^2}{X(x)}+\frac{d^2Y(y)/dy^2}{Y(y)}=0\tag{19.7}$$

因为$X(x)$仅是x的函数，而$Y(y)$仅是y的函数，所以（19.7）中的导数是普通的，而不是偏导数。因为假设$X(x)$和$Y(y)$是独立的，所以（19.7）对x和y的所有值都有效的唯一方法是（19.7）中的每个项都等于一个常数：

$$\frac{d^2Y(y)/dy^2}{Y(y)}=-\frac{d^2X(x)/dx^2}{X(x)}=k^2\tag{19.8}$$

$$=>\frac{d^2X(x)}{dx^2}+k^2X(x)=0,\frac{d^2Y(y)}{dy^2}+k^2Y(y)=0\tag{19.9}$$

## 19.4 有限差分法

为了在数值上求解我们的2D PDE，我们将空间划分为一个晶格（图19.3），并在晶格上的每个位置求解U。因为我们将用晶格位置U值的有限差来表示导数，所以这被称为有限差分方法。一种在数值上更有效但设置更复杂的方法是有限元法（FEM），它求解小几何元素的PDE，然后在元素上匹配解。我们将在第23章中讨论有限元法。

为了推导（19.5）数值解的有限差分算法，我们仿照第5.1节中的相同方式来推导微分的前向差分算法。我们首先写出势在（x，y）右边和左边两个泰勒展开式，以及上面和下面的两个展开式：

$$U(x+\Delta x,y)=U(x,y)+\frac{\partial U}{\partial x}\Delta x+\frac{1}{2}\frac{\partial^2 U}{\partial x^2}(\Delta x)^2+...\tag{19.20}$$

$$U(x-\Delta x,y)=U(x,y)-\frac{\partial U}{\partial x}\Delta x+\frac{1}{2}\frac{\partial^2 U}{\partial x^2}(\Delta x)^2+...\tag{19.21}$$

$$U(x,y+\Delta y)=U(x,y)+\frac{\partial U}{\partial y}\Delta y+\frac{1}{2}\frac{\partial^2 U}{\partial y^2}(\Delta y)^2+...\tag{19.22}$$

$$U(x,y-\Delta y)=U(x,y)-\frac{\partial U}{\partial y}\Delta y+\frac{1}{2}\frac{\partial^2 U}{\partial y^2}(\Delta y)^2+...\tag{19.23}$$

当我们把这些方程成对相加时，所有的奇数项都会抵消，我们得到了二阶偏导数的中心差分近似：

$$\frac{\partial^2 U(x,y)}{\partial x^2}\simeq\frac{U(x+\Delta x,y)+U(x-\Delta x,y)-2U(x,y)}{(\Delta x)^2}\tag{19.24}$$

$$\frac{\partial^2 U(x,y)}{\partial y^2}\simeq\frac{U(x,y+\Delta y)+U(x,y-\Delta y)-2U(x,y)}{(\Delta y)^2}\tag{19.25}$$

泊松方程（19.6）中这两种近似值的替换使我们得出了PDE的有限差分形式：

$$\frac{U(x+\Delta x,y)+U(x-\Delta x,y)-2U(x,y)}{(\Delta x)^2}\tag{19.26}$$

$$+\frac{U(x,y+\Delta y)+U(x,y-\Delta y)-2U(x,y)}{(\Delta y)^2}=-4\pi\rho\tag{19.27}$$

我们假定x和y网格具有相等的间距$\Delta x=\Delta y=\Delta$，从而获得方程的一个简单形式：

$$U(x+\Delta,y)+U(x-\Delta,y)+U(x,y+\Delta)+U(x,y-\Delta)-4U(x,y)=-4\pi\rho\tag{19.28}$$

读者会注意到，这个方程显示了空间中五个点的解之间的关系。当使用$U(x,y)$求解网格上的$N_x$的x个值与$N_y$的y个值，我们得到了一组$N_x\times N_y$联立线性代数方程，供$U[i,j]$求解。一种方法是将这些方程明确地作为一个（大）矩阵问题来求解。这很有吸引力，因为这是一个直接的解决方案，但它需要大量的内存和核算。我们使用的方法来自$U(x,y)$的（19.28）代数解：

$$4U(x,y)\simeq U(x+\Delta,y)+U(x-\Delta,y)+U(x,y+\Delta)+U(x,y-\Delta)+4\pi\rho(x,y)\Delta^2\tag{19.29}$$

其中我们将省略拉普拉斯方程的ρ（x）项。就晶格上的离散位置而言，x和y变量为：

$$x=x_0+i\Delta;y=y_0+j\Delta;i,j=0,...,N_{max-1}\tag{19.30}$$

其中我们将晶格放置在L边的正方形中。有限差分算法（19.29）变为：

$$U_{i,j}=\frac{1}{4}[U_{i+1,j}+U_{i-1,j}+U_{i,j+1}+U_{i,j-1}]+\pi\rho(i\Delta,j\Delta)\Delta^2\tag{19.31}$$

这个方程表明，当我们有一个合适的解时，它将是四个最近邻居的电势的平均值（图19.3）加上局部电荷密度的贡献。作为一种算法，（19.31）并不提供泊松方程的直接解，而是必须重复多次才能收敛于解。我们从对潜力的初步猜测开始，通过扫描所有空间来改进它，在每个节点上取最近邻居的平均值，并不断重复这个过程，直到解决方案不再改变到某种精度水平，或者直到失败明显为止。当收敛时，据说最初的猜测已经松弛到了解中。

对于这种简单的方法，一个合理的问题是，“它总是收敛吗？如果是，它收敛得足够快吗？”从某种意义上说，第一个问题的答案不是问题；如果该方法不收敛，那么我们就会知道它；否则，我们最终得到了一个解决方案，而我们所走的道路与任何人无关！速度问题的答案是，松弛方法可能收敛缓慢（尽管仍然比傅立叶级数快），但我们将向您展示两个加速收敛的聪明技巧。

在这一点上，重要的是要记住，我们的算法是由在直角坐标系中对拉普拉斯算子$\nabla^2$进行外压而产生的。虽然这并不限制我们解决圆对称问题，但在某些几何体中，最好开发一种基于在柱坐标或球面坐标中表达拉普拉斯算子的算法，以使网格更适合几何体。

## 19.4.1 松弛与过度松弛

有多种方法可以迭代算法（19.31），以便将边界条件转换为解。其最基本的形式是雅可比方法，并且是一种直到在每个点上完成整个应用扫描（19.31）为止，电势值不改变的方法。这保持了初始猜测和边界条件的对称性。对雅可比方法的一个相当明显的改进是，一旦（19.31）中的潜力可用，就利用更新的猜测。举个例子，如果扫描从图19.3的左上角开始，则使用的电势的最左边的U（[–1，j]和最上面的U[i，j–1]值将来自当前一代的猜测，而电势的其他两个值将来自上一代：（高斯-塞德尔法）



这种被称为高斯-塞德尔方法的技术通常会加速收敛，从而减少舍入误差。它还使用较少的内存，因为不需要存储两代人的猜测。然而，它确实扭曲了边界条件的对称性，人们希望当达到收敛时，这是微不足道的。

弛豫技术的一个不太明显的改进，称为连续过弛豫（SOR），始于以将电势U（new）的新值确定为旧值U（old）加上校正或残差r的形式写入算法（19.31）：



虽然高斯-塞德尔技术仍然可以用于将更新后的值合并到U（旧）中以确定r，但我们在这里以一般形式重写了算法



逐次过松弛技术（Press et al.，1994；Garcia，2000）提出，如果通过将r添加到U来获得收敛，那么通过添加或多或少的r可以获得更快速的收敛



其中ω是放大或减少残差的参数。ω=1时得到非加速松弛算法（19.32），ω≥1时得到加速收敛（过松弛），ω<1时得到欠松弛。1≤ω≤2的值通常工作良好，但ω>2可能导致数值不稳定性。尽管需要对算法进行详细分析来预测ω的最佳值，但我们建议您探索ω的不同值，看看哪一个最适合您的特定问题。